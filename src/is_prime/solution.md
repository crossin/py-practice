# 素数判别

### 【解决思路】

1. 首先我们来看看常见的素数判别算法，无非是循环法，或是筛法，或是查表法等等。尽管他们都有很多的优化手段，但是总体来讲还是需要很大的时间/空间复杂度。

2. 有人会说，我的算法输入100，就循环100次，所以我的算法时间复杂度是`o(n)`，你能指出错误在哪么？

3. 有关素数检测，是一个非常常见且基础的问题，在密码学中尤为重要。事实上目前也有很多高效的确定性算法来判别素数。但是我将要介绍的，是另一类算法。它的名字叫"[米勒-拉宾素性检验](https://zh.wikipedia.org/wiki/%E7%B1%B3%E5%8B%92-%E6%8B%89%E5%AE%BE%E6%A3%80%E9%AA%8C)"，正如你所见，它是一个“随机”算法。

   所谓随机算法（其实之前介绍的“蒙特卡洛方法”也是一种随机算法），即它得到的不一定是正确的结果，但是优点在于，它每次只要耗费常数级的时间，就可以很大概率地判断一个数是否是素数。譬如只要运算100次，就可以保证错误率小于 $\frac{1}{2^{100}}$ ，这是什么概念呢？要知道，宇宙中全部粒子的总数，还不到 $2^{80}$ ！这个概率远比计算机出错的概率还低，所以万一误判的话，赶紧去买一张彩票，因为你的运气实在是太好了！

4. 此算法的原理，是著名的“[费马小定理](https://zh.wikipedia.org/zh/%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86)”，具体内容你可以参见百科。大致思路就是提供了一个数是素数的必要不充分条件。

5. 但是如果只依靠费马小定理的话，并不能得到正确的结果，因为有一类数称为“[卡迈克尔数](https://zh.wikipedia.org/wiki/%E5%8D%A1%E9%82%81%E5%85%8B%E7%88%BE%E6%95%B8)”，又称“伪素数”。即遇到这些数，那么基于费马小定理的素数判别算法便失效了。但是使用MR素数判别算法却可以避免这个问题。

6. 另外的两个问题，也都是随机算法经典问题，如果你要用确定性算法的话，付出的代价是极大的。但是如果你用随机算法，就可以在很短时间内，获得相对来说非常好的结果，何乐而不为呢？【关键词：Randomized Min-Cut, hash】

7. 此题的具体算法实现并不重要（可以参考《算法导论》），但是重要的是这种解决问题的思路。当用传统方法很难解决一个问题时，或许换个思路就能得到很好的结果。而区别普通程序员和优秀工程师的一大关键因素就在于此。本题也只能算一个引导，希望你能主动钻研。

   ​

   ​

